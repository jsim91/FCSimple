% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/fcs_add_metadata.R
\name{fcs_add_metadata}
\alias{fcs_add_metadata}
\title{Add Custom Metadata to an FCSimple Object}
\usage{
fcs_add_metadata(fcs_join_obj, custom_metadata, suffix = c(".obj", ".custom"))
}
\arguments{
\item{fcs_join_obj}{An FCSimple analysis object (list) returned by \code{FCSimple::fcs_join()}.
Must contain a \code{metadata} element with a \code{patient_ID} column.}

\item{custom_metadata}{A data frame containing additional metadata to merge. Must have a
\code{patient_ID} column that matches values in \code{fcs_join_obj$metadata$patient_ID}.
Additional columns will be added to the object's metadata.}

\item{suffix}{Character vector of length 2; suffixes to append to duplicate column
names (excluding \code{patient_ID}). Default \code{c(".obj", ".custom")}.
Passed to \code{merge()}.}
}
\value{
The input \code{fcs_join_obj} with an updated \code{metadata} element containing
the merged data, and an updated \code{object_history} recording the operation.
}
\description{
Merges user-supplied metadata into the \code{metadata} slot of an FCSimple
analysis object created by \code{FCSimple::fcs_join()}. The custom metadata
is joined on the \code{patient_ID} column using \code{merge()}, allowing you to
add clinical, demographic, or other external information to your flow
or mass cytometry dataset.
}
\details{
The function validates that:
\itemize{
\item \code{fcs_join_obj} is a list with a \code{metadata} element
\item Both \code{fcs_join_obj$metadata} and \code{custom_metadata} have a \code{patient_ID} column
\item There is at least one matching \code{patient_ID} between the two datasets
}

The merge is performed using \code{base::merge()}, which performs a SQL-like join.
After merging, the updated metadata is stored back in \code{fcs_join_obj$metadata},
and a timestamped entry is appended to \code{object_history}.
}
\examples{
\dontrun{
  # Load and join FCS files
  files <- list.files("data/fcs", "\\\\.fcs$", full.names = TRUE)
  joined <- FCSimple::fcs_join(files)

  # Create custom metadata with patient_ID and clinical info
  clinical_data <- data.frame(
    patient_ID = c("patient1", "patient2", "patient3"),
    age = c(45, 52, 38),
    treatment = c("A", "B", "A"),
    response = c("CR", "PR", "NR")
  )

  # Add custom metadata to the object
  joined <- FCSimple::fcs_add_metadata(joined, clinical_data)

  # View the updated metadata
  head(joined$metadata)
}

}
\seealso{
FCSimple::fcs_join, FCSimple::fcs_update, base::merge
}
