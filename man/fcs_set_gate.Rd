% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/fcs_gating.R
\name{fcs_set_gate}
\alias{fcs_set_gate}
\title{Set a Gate Based on EM Cutpoint}
\usage{
fcs_set_gate(
  object,
  feature,
  tree_name = "tree1",
  parent_name = "cells",
  gate_name = "singlets1",
  em_method = c("mclust", "mix"),
  general_method = c("gmm", "flex", "mean"),
  post.thresh = 0.5,
  prom_tol = 0.05,
  flex_tail = 0.75,
  bw_adjust = 2,
  n_grid = 512,
  curvature_eps = 0.01
)
}
\arguments{
\item{object}{An “fcs_gating_object” or numeric vector.}

\item{feature}{Character; column name of the feature in object$data.}

\item{tree_name}{Character; gating tree name (default “tree1”).}

\item{parent_name}{Character; parent gate (default “none”).}

\item{gate_name}{Character; new gate label (no “+”/“–” allowed).}

\item{em_method}{Character; “mclust” or “mix” (default).}

\item{general_method}{Character; “gmm”, “flex”, “mean”, or “both” (default).}

\item{post.thresh}{Numeric; posterior threshold (default 0.5).}

\item{prom_tol}{Numeric; component proportion threshold (default 0.05).}

\item{flex_tail}{Numeric; quantile for flex fallback (default 0.75).}

\item{bw_adjust}{Numeric; density bandwidth adjust (default 2).}

\item{n_grid}{Integer; grid length for density (default 512).}

\item{curvature_eps}{Numeric; curvature tolerance (default 0.01).}
}
\value{
If input is an “fcs_gating_object”, returns it with a new branch under  
  `gate_trees[[tree_name]][[gate_name]]` containing positive/negative masks and cutpoint.  
  Otherwise returns a list with cutpoint data.
}
\description{
Wrapper around fcs_get_em_cutpoint() to apply a univariate gate on  
  a single feature, storing positive/negative masks in the gating object.
}
\seealso{
fcs_get_em_cutpoint
}
