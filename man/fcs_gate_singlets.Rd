% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/fcs_gating.R
\name{fcs_gate_singlets}
\alias{fcs_gate_singlets}
\title{Gate Singlets by Height vs Area}
\usage{
fcs_gate_singlets(
  object,
  tree_name = "tree1",
  parent_name = "cells",
  gate_name = "singlets",
  a = "SSC-A",
  h = "SSC-H",
  cut_method = c("gmm", "flex", "both"),
  fit_method = c("lm", "rlm"),
  trim_frac = 0.01,
  curvature_eps = 0.001
)
}
\arguments{
\item{object}{An “fcs_gating_object”, or a data.frame/matrix with columns \code{a} and \code{h}.}

\item{tree_name}{Character; gating tree name (default “tree1”).}

\item{parent_name}{Character; parent gate (default “cells”).}

\item{gate_name}{Character; new gate label (no “+”/“–” allowed).}

\item{a}{Character; area channel name (default “SSC-A”).}

\item{h}{Character; height channel name (default “SSC-H”).}

\item{cut_method}{Character; “gmm”, “flex”, or “both” (default).}

\item{fit_method}{Character; “lm” or “rlm” (default “lm”).}

\item{trim_frac}{Numeric; fraction to trim when fitting (default 0.01).}

\item{curvature_eps}{Numeric; curvature tolerance for flex-cut (default 0.001).}
}
\value{
If \code{object} is an “fcs_gating_object”, adds branch under
\code{gate_trees[[tree_name]][[gate_name]]} with positive/negative masks,
threshold, fit parameters, and returns the updated object.
Otherwise returns a data.frame of gated events.
}
\description{
Identifies singlet events by fitting a robust or least‐squares line
to A vs H channels, computing residuals, then applying an EM-based or
curvature-based cutpoint to select events above the threshold.
}
\details{
\itemize{
\item Subsets central data by trim_frac.
\item Fits \code{lm()} or \code{MASS::rlm()} of h ~ a.
\item Computes residuals and calls fcs_get_em_cutpoint() for threshold.
\item Masks events above cutpoint as singlets.
}
}
\examples{
\dontrun{
  go <- fcs_gating_object(joined)
  go2 <- fcs_gate_singlets(go, gate_name = "singlets")
}

}
\seealso{
fcs_gate_cells, fcs_get_em_cutpoint, MASS::rlm
}
