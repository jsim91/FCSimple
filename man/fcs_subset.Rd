% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/fcs_subset.R
\name{fcs_subset}
\alias{fcs_subset}
\title{Subset FCSimple Analysis Object by Sample or Cluster}
\usage{
fcs_subset(
  fcs_join_obj,
  subset_by = c("cluster", "source"),
  subset_cluster_algorithm = NA,
  subset_values
)
}
\arguments{
\item{fcs_join_obj}{A list returned by FCSimple::fcs_join(), optionally processed by
FCSimple::fcs_cluster() or other functions. Should include at least
`data` (numeric matrix) and `source` (vector of sample identifiers).}

\item{subset_by}{Character; one of `"source"` or `"cluster"`. Determines whether to subset
by sample names (`source`) or by cluster membership (`cluster`).
Default `c("cluster","source")`.}

\item{subset_cluster_algorithm}{Character or `NA`; when `subset_by = "cluster"`, the name of the clustering
element in `fcs_join_obj` (e.g. `"leiden"`, `"flowsom"`). Ignored if
`subset_by = "source"`. Default `NA`.}

\item{subset_values}{Vector; the values to retain. If `subset_by = "source"`, a character
vector of sample names. If `subset_by = "cluster"`, a numeric or character
vector of cluster IDs.}
}
\value{
A list with elements:
  - `data`: numeric matrix of selected events Ã— parameters  
  - `source`: character vector of sample IDs for selected events  
  - `run_date`: character vector of acquisition dates (if original had it)  
  - `subset_on`: list recording subsetting criteria and indices
}
\description{
Creates a new FCSimple-style object containing only the events that match
  specified sample names or cluster IDs. Records the subsetting criteria and
  original indices in a `subset_on` element for provenance.
}
\details{
- If the input object lacks an `object_history` entry, prints a message
    recommending `FCSimple::fcs_update()`.  
  - When subsetting by `"source"`, all rows where
    `fcs_join_obj$source %in% subset_values` are retained.  
  - When subsetting by `"cluster"`, the function extracts
    `fcs_join_obj[[subset_cluster_algorithm]]$clusters` and retains rows
    matching `subset_values`.  
  - The returned object contains only the selected `data`, `source`, and
    (if present) `run_date` entries.  
  - A new list element `subset_on` records:
    - `subset_by`, `subset_cluster_algorithm`, `subset_values`, and
      `source_object_indices` (the row indices kept).
}
\examples{
\dontrun{
# Subset by sample names
joined <- FCSimple::fcs_join(files)
sel1 <- FCSimple::fcs_subset(
  joined,
  subset_by = "source",
  subset_values = c("SampleA","SampleC")
)

# Subset by Leiden clusters
clustered <- FCSimple::fcs_cluster(joined, algorithm = "leiden")
sel2 <- FCSimple::fcs_subset(
  clustered,
  subset_by = "cluster",
  subset_cluster_algorithm = "leiden",
  subset_values = c(1, 3, 5)
)
}

}
\seealso{
FCSimple::fcs_join, FCSimple::fcs_cluster, FCSimple::fcs_update
}
