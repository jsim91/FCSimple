% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/fcs_cluster_abundance.R
\name{fcs_calculate_abundance}
\alias{fcs_calculate_abundance}
\title{Calculate Cluster Abundance Across Samples}
\usage{
fcs_calculate_abundance(
  fcs_join_obj,
  report_algorithm = c("leiden", "flowsom", "louvain", "phenograph", "git"),
  report_as = c("frequency", "fraction")
)
}
\arguments{
\item{fcs_join_obj}{A list returned by FCSimple::fcs_join() and FCSimple::fcs_cluster(),
containing at minimum:
\itemize{
\item \code{source}: a character vector of original sample identifiers
\item \verb{<algorithm>}: a list whose first element is a vector of cluster IDs
\item \code{object_history}: an optional history log
}}

\item{report_algorithm}{Character; name of the clustering result to summarize. One of
\code{"leiden"}, \code{"flowsom"}, \code{"louvain"}, \code{"phenograph"}, or \code{"git"}.}

\item{report_as}{Character; type of abundance metric. \code{"frequency"} (0–100) or
\code{"fraction"} (0–1). Defaults to \code{"frequency"}.}
}
\value{
The input \code{fcs_join_obj}, augmented with:
\itemize{
\item \verb{<algorithm>$abundance}: a numeric matrix (samples × clusters)
\item updated \code{object_history} entry
}
}
\description{
Computes per‐sample cluster abundances for a previously clustered flow
cytometry object. Stores a matrix of frequencies (0–100) or fractions
(0–1) under the chosen algorithm’s \code{abundance} element, and appends an
entry to \code{object_history}.
}
\details{
The function will:
\enumerate{
\item Validate that the specified algorithm and \code{source} exist.
\item Tabulate the proportion of cells in each cluster, per sample.
\item Multiply by 100 if \code{report_as = "frequency"}.
\item Store the result in \code{fcs_join_obj[[report_algorithm]][["abundance"]]}.
\item Append a timestamped note to \code{object_history}.
}
}
\examples{
\dontrun{
  joined <- FCSimple::fcs_join(list(ff1, ff2))
  clustered <- FCSimple::fcs_cluster(joined, algorithm = "leiden")

  # Get percentage abundance for Leiden clusters
  out <- FCSimple::fcs_calculate_abundance(
    clustered,
    report_algorithm = "leiden",
    report_as = "frequency"
  )
}

}
\seealso{
FCSimple::fcs_cluster, FCSimple::fcs_report_abundance
}
