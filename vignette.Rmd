---
title: "FCSimple workflow 2/4/2024"
author:
- name: Josh Simmons
  affiliation: Vanderbilt University Medical Center
  email: joshua.d.simmons@vumc.org
package: FCSimple
output:
  BiocStyle::html_document
abstract: |
  FCSimple workflow
vignette: |
  %\VignetteIndexEntry{Vignette Title}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---

```{r include=FALSE}
setwd("J:/FCSimple_vignette_outs")
```


Start by getting the paths to a few sample FCS files included with the FCSimple library.

```{r}
vignette_files <- fcs_load_data()
vignette_files
```

Next, create a list object using the fcs_join function. Note, for any function, you can view the function arguments like this:

```{r}
args(fcs_join)
```

You should either (1) set the transform parameters manually and set transform_per_channel = FALSE or (2) use the default function arguments and set transform_per_channel = TRUE to use the shiny app to interactively set your transforms. Default is TRUE. Here I will specify transform parameters that are generally acceptable for the analysis of any cytof data. If using fluorescence data and the "asinh" transform_type, consider setting the asinh_transform_cofactor to around 250. Default asinh_transform_cofactor is 5.

```{r}
fcs_obj <- fcs_join(files = vignette_files, instrument_type = "cytof", transform_type = "asinh", asinh_transform_cofactor = 5, downsample_size = NA, transform_per_channel = FALSE)
```

The list object will include, by default, (1) the transform data under the data element, (2) the raw untransformed data under the raw element, and (3) the file source of each cell.

```{r}
summary(fcs_obj)
```

```{r}
head(fcs_obj$data)
```

```{r}
table(fcs_obj$source)
```

For readability, I will trim the metal names off of the data matrix column names.

```{r}
colnames(fcs_obj$data) <- gsub(pattern = "^.+_", replacement = "", x = colnames(fcs_obj$data))
head(fcs_obj$data,3)
```

I can check the distributions of the transformed data if I want using fcs_plot_distribution. The figure will be written to whatever is specified using the outdir argument. I will specify the oudir to be the current working directory.

```{r}
fcs_plot_distribution(fcs_join_obj = fcs_obj, separate_by = "none", outdir = "./", add_timestamp = FALSE)
```
![]()

```{r}

```

```{r}

```

```{r}

```

```{r}

```

```{r}

```

```{r}

```

```{r}

```

```{r}

```

```{r}

```

```{r}

```

```{r}

```

```{r}

```

```{r}

```

```{r}

```






# Getting started

To enable the _Bioconductor_ style in your R Markdown vignette you need to include the following in the `DESCRIPTION` file:

    VignetteBuilder: knitr
    Suggests: BiocStyle, knitr, rmarkdown


# Style macros

_BiocStyle_ introduces the following macros for referring to _R_ packages:

* `r Biocpkg("IRanges")`, for _Bioconductor_ software, annotation and experiment data packages,
* `r CRANpkg("data.table")`, for _R_ packages available on CRAN,
* `r Githubpkg("rstudio/rmarkdown")`, for _R_ packages available on GitHub,
* `r Rpackage("MyPkg")`, for _R_ packages that are _not_ available on _Bioconductor_, CRAN or GitHub.


# Figures

Assign captions to figures in the code chunk option `fig.cap` to automatically number them, and to be able to reference them, see Figure \@ref(fig:plot). The figure label is generated from the code chunk label by prefixing it with `fig:`.

```{r plot, fig.cap="Regular figure. The first sentence of the figure caption is automatically emphasized to serve as figure title.", echo=FALSE}
plot(cars)
```

Small and wide figures can be specified by `fig.small` and `fig.wide` code chunk options.

```{r small, fig.cap="Small figure. A plot produced by a code chunk with option `fig.small = TRUE`.", fig.small=TRUE, echo=FALSE}
plot(cars)
```

```{r wide, fig.cap="Wide figure. A plot produced by a code chunk with option `fig.wide = TRUE`.", fig.wide=TRUE, echo=FALSE}
plot(cars)
```


# Equations

To number and reference equations, put them in equation environments and assign labels to them, see Equation \@ref(eq:binom).

\begin{equation}
  f\left(k\right) = \binom{n}{k} p^k\left(1-p\right)^{n-k}
  (\#eq:binom)
\end{equation}


# Tables

Like figures, tables with captions will also be numbered and can be referenced, see Table \@ref(tab:table).

Fruit   | Price
------- | -----
bananas | 1.2
apples  | 1.0
oranges | 2.5

: (\#tab:table) A simple table. With caption.


# Cross-references

Apart from referencing figures (Section \@ref(figures)), tables (Section \@ref(tables)), and equations (Section \@ref(equations)), you can also use the same syntax to refer to sections by their default labels generated by pandoc.


# Side notes

Footnotes are displayed as side notes on the right margin^[this is a side note entered as a footnote], which has the advantage that they appear close to the place where they are defined.

# References {.unnumbered}


# Session info

```{r sessionInfo, echo=FALSE}
sessionInfo()
```
