% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/fcs_gating.R
\name{fcs_gate_cells}
\alias{fcs_gate_cells}
\title{Gate Cells by SSC-A vs FSC-A}
\usage{
fcs_gate_cells(
  object,
  tree_name = "tree1",
  parent_name = "none",
  gate_name = "cells",
  side_a = "SSC-A",
  forward_a = "FSC-A",
  drop_nearest = 1,
  drop_farthest = 1
)
}
\arguments{
\item{object}{An “fcs_gating_object”, or a data.frame/matrix with columns \code{side_a} and
\code{forward_a}.}

\item{tree_name}{Character; name of the gating tree (default “tree1”).}

\item{parent_name}{Character; name of the parent gate in the tree (default “none”).}

\item{gate_name}{Character; new gate label (no “+”/“–” allowed).}

\item{side_a}{Character; name of side‐scatter channel (default “SSC-A”).}

\item{forward_a}{Character; name of forward‐scatter channel (default “FSC-A”).}

\item{drop_nearest}{Integer; number of nearest‐to‐origin components to drop (default 1).}

\item{drop_farthest}{Integer; number of farthest‐from‐origin components to drop (default 1).}
}
\value{
If \code{object} is an “fcs_gating_object”, returns it with:
\itemize{
\item \code{object$gate_trees[[tree_name]][[gate_name]]}: list with
\itemize{
\item mask, tree, parent, feature_side_a, feature_forward_a, gate_fn,
chull_selection (hull vertices + cluster indices).
Otherwise returns a list with:
}
\item cells: data.frame of gated events
\item hull_vertices: data.frame of hull points
\item kept_clusters: integer indices
\item dropped_clusters: integer indices
}
}
\description{
Identifies the main cell population by fitting a bivariate Gaussian mixture
model (Mclust) on side‐scatter (SSC‐A) vs forward‐scatter (FSC‐A), drops the
nearest/farthest mixture components, computes a convex hull of retained events,
and returns the gating mask (and adds it to the gating object if provided).
}
\details{
\itemize{
\item Fits \code{mclust::Mclust(df[,c(side_a, forward_a)], modelNames="VVV")}.
\item Computes center distances to origin, orders components, drops extremes.
\item Builds convex hull of retained points with \code{chull()}.
\item Binary mask: event inside hull = 1, else 0.
}
}
\examples{
\dontrun{
  go <- fcs_gating_object(joined)
  gated <- fcs_gate_cells(go, gate_name = "cells")
}

}
\seealso{
fcs_gating_object, mclust::Mclust, sp::point.in.polygon
}
